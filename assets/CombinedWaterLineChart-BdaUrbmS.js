import{aH as Fe,m as b,v as Ve,r as V,aI as ge,d as te,x as B,I as xe,aJ as Se,K as Ce,V as $e,av as Re,T as de,R as G,z as F,y as M,C as X,Y as H,ap as je,aq as He,ar as Oe,Z as Ue,a7 as Ke,ad as We,ai as le,J as Me,M as Xe,O as Ye,aw as qe,q as Te,aK as Qe,U as ke,af as Q,s as Je,a4 as ye,ah as Ze,k as et,aL as tt,aM as ot,aN as we,as as nt,o as w,c as _,e as S,F as J,l as Z,t as I,b as ie,aO as ce,aF as q,n as ee,aP as Be,_ as ze,aQ as at,p as rt}from"./index-uAypqIvn.js";import{g as st}from"./get-slot-Bk_rJcZu.js";function lt(e){if(typeof e=="number")return{"":e.toString()};const t={};return e.split(/ +/).forEach(n=>{if(n==="")return;const[o,s]=n.split(":");s===void 0?t[""]=o:t[o]=s}),t}function Y(e,t){var n;if(e==null)return;const o=lt(e);if(t===void 0)return o[""];if(typeof t=="string")return(n=o[t])!==null&&n!==void 0?n:o[""];if(Array.isArray(t)){for(let s=t.length-1;s>=0;--s){const i=t[s];if(i in o)return o[i]}return o[""]}else{let s,i=-1;return Object.keys(o).forEach(m=>{const v=Number(m);!Number.isNaN(v)&&t>=v&&v>=i&&(i=v,s=o[m])}),s}}const it={xs:0,s:640,m:1024,l:1280,xl:1536,"2xl":1920};function ct(e){return`(min-width: ${e}px)`}const se={};function dt(e=it){if(!Fe)return b(()=>[]);if(typeof window.matchMedia!="function")return b(()=>[]);const t=V({}),n=Object.keys(e),o=(s,i)=>{s.matches?t.value[i]=!0:t.value[i]=!1};return n.forEach(s=>{const i=e[s];let m,v;se[i]===void 0?(m=window.matchMedia(ct(i)),m.addEventListener?m.addEventListener("change",g=>{v.forEach(d=>{d(g,s)})}):m.addListener&&m.addListener(g=>{v.forEach(d=>{d(g,s)})}),v=new Set,se[i]={mql:m,cbs:v}):(m=se[i].mql,v=se[i].cbs),v.add(o),m.matches&&v.forEach(g=>{g(m,s)})}),Ve(()=>{n.forEach(s=>{const{cbs:i}=se[e[s]];i.has(o)&&i.delete(o)})}),b(()=>{const{value:s}=t;return n.filter(i=>s[i])})}function ut(e){var t;const n=(t=e.dirs)===null||t===void 0?void 0:t.find(({dir:o})=>o===ge);return!!(n&&n.value===!1)}const Ne=$e("n-checkbox-group"),ft={min:Number,max:Number,size:String,value:Array,defaultValue:{type:Array,default:null},disabled:{type:Boolean,default:void 0},"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onChange:[Function,Array]},to=te({name:"CheckboxGroup",props:ft,setup(e){const{mergedClsPrefixRef:t}=xe(e),n=Se(e),{mergedSizeRef:o,mergedDisabledRef:s}=n,i=V(e.defaultValue),m=b(()=>e.value),v=Ce(m,i),g=b(()=>{var p;return((p=v.value)===null||p===void 0?void 0:p.length)||0}),d=b(()=>Array.isArray(v.value)?new Set(v.value):new Set);function k(p,l){const{nTriggerFormInput:y,nTriggerFormChange:C}=n,{onChange:x,"onUpdate:value":$,onUpdateValue:h}=e;if(Array.isArray(v.value)){const a=Array.from(v.value),E=a.findIndex(z=>z===l);p?~E||(a.push(l),h&&G(h,a,{actionType:"check",value:l}),$&&G($,a,{actionType:"check",value:l}),y(),C(),i.value=a,x&&G(x,a)):~E&&(a.splice(E,1),h&&G(h,a,{actionType:"uncheck",value:l}),$&&G($,a,{actionType:"uncheck",value:l}),x&&G(x,a),i.value=a,y(),C())}else p?(h&&G(h,[l],{actionType:"check",value:l}),$&&G($,[l],{actionType:"check",value:l}),x&&G(x,[l]),i.value=[l],y(),C()):(h&&G(h,[],{actionType:"uncheck",value:l}),$&&G($,[],{actionType:"uncheck",value:l}),x&&G(x,[]),i.value=[],y(),C())}return Re(Ne,{checkedCountRef:g,maxRef:de(e,"max"),minRef:de(e,"min"),valueSetRef:d,disabledRef:s,mergedSizeRef:o,toggleCheckbox:k}),{mergedClsPrefix:t}},render(){return B("div",{class:`${this.mergedClsPrefix}-checkbox-group`,role:"group"},this.$slots)}}),vt=()=>B("svg",{viewBox:"0 0 64 64",class:"check-icon"},B("path",{d:"M50.42,16.76L22.34,39.45l-8.1-11.46c-1.12-1.58-3.3-1.96-4.88-0.84c-1.58,1.12-1.95,3.3-0.84,4.88l10.26,14.51  c0.56,0.79,1.42,1.31,2.38,1.45c0.16,0.02,0.32,0.03,0.48,0.03c0.8,0,1.57-0.27,2.2-0.78l30.99-25.03c1.5-1.21,1.74-3.42,0.52-4.92  C54.13,15.78,51.93,15.55,50.42,16.76z"})),ht=()=>B("svg",{viewBox:"0 0 100 100",class:"line-icon"},B("path",{d:"M80.2,55.5H21.4c-2.8,0-5.1-2.5-5.1-5.5l0,0c0-3,2.3-5.5,5.1-5.5h58.7c2.8,0,5.1,2.5,5.1,5.5l0,0C85.2,53.1,82.9,55.5,80.2,55.5z"})),bt=F([M("checkbox",`
 font-size: var(--n-font-size);
 outline: none;
 cursor: pointer;
 display: inline-flex;
 flex-wrap: nowrap;
 align-items: flex-start;
 word-break: break-word;
 line-height: var(--n-size);
 --n-merged-color-table: var(--n-color-table);
 `,[X("show-label","line-height: var(--n-label-line-height);"),F("&:hover",[M("checkbox-box",[H("border","border: var(--n-border-checked);")])]),F("&:focus:not(:active)",[M("checkbox-box",[H("border",`
 border: var(--n-border-focus);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),X("inside-table",[M("checkbox-box",`
 background-color: var(--n-merged-color-table);
 `)]),X("checked",[M("checkbox-box",`
 background-color: var(--n-color-checked);
 `,[M("checkbox-icon",[F(".check-icon",`
 opacity: 1;
 transform: scale(1);
 `)])])]),X("indeterminate",[M("checkbox-box",[M("checkbox-icon",[F(".check-icon",`
 opacity: 0;
 transform: scale(.5);
 `),F(".line-icon",`
 opacity: 1;
 transform: scale(1);
 `)])])]),X("checked, indeterminate",[F("&:focus:not(:active)",[M("checkbox-box",[H("border",`
 border: var(--n-border-checked);
 box-shadow: var(--n-box-shadow-focus);
 `)])]),M("checkbox-box",`
 background-color: var(--n-color-checked);
 border-left: 0;
 border-top: 0;
 `,[H("border",{border:"var(--n-border-checked)"})])]),X("disabled",{cursor:"not-allowed"},[X("checked",[M("checkbox-box",`
 background-color: var(--n-color-disabled-checked);
 `,[H("border",{border:"var(--n-border-disabled-checked)"}),M("checkbox-icon",[F(".check-icon, .line-icon",{fill:"var(--n-check-mark-color-disabled-checked)"})])])]),M("checkbox-box",`
 background-color: var(--n-color-disabled);
 `,[H("border",`
 border: var(--n-border-disabled);
 `),M("checkbox-icon",[F(".check-icon, .line-icon",`
 fill: var(--n-check-mark-color-disabled);
 `)])]),H("label",`
 color: var(--n-text-color-disabled);
 `)]),M("checkbox-box-wrapper",`
 position: relative;
 width: var(--n-size);
 flex-shrink: 0;
 flex-grow: 0;
 user-select: none;
 -webkit-user-select: none;
 `),M("checkbox-box",`
 position: absolute;
 left: 0;
 top: 50%;
 transform: translateY(-50%);
 height: var(--n-size);
 width: var(--n-size);
 display: inline-block;
 box-sizing: border-box;
 border-radius: var(--n-border-radius);
 background-color: var(--n-color);
 transition: background-color 0.3s var(--n-bezier);
 `,[H("border",`
 transition:
 border-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
 border-radius: inherit;
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border: var(--n-border);
 `),M("checkbox-icon",`
 display: flex;
 align-items: center;
 justify-content: center;
 position: absolute;
 left: 1px;
 right: 1px;
 top: 1px;
 bottom: 1px;
 `,[F(".check-icon, .line-icon",`
 width: 100%;
 fill: var(--n-check-mark-color);
 opacity: 0;
 transform: scale(0.5);
 transform-origin: center;
 transition:
 fill 0.3s var(--n-bezier),
 transform 0.3s var(--n-bezier),
 opacity 0.3s var(--n-bezier),
 border-color 0.3s var(--n-bezier);
 `),je({left:"1px",top:"1px"})])]),H("label",`
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 user-select: none;
 -webkit-user-select: none;
 padding: var(--n-label-padding);
 font-weight: var(--n-label-font-weight);
 `,[F("&:empty",{display:"none"})])]),He(M("checkbox",`
 --n-merged-color-table: var(--n-color-table-modal);
 `)),Oe(M("checkbox",`
 --n-merged-color-table: var(--n-color-table-popover);
 `))]),pt=Object.assign(Object.assign({},Me.props),{size:String,checked:{type:[Boolean,String,Number],default:void 0},defaultChecked:{type:[Boolean,String,Number],default:!1},value:[String,Number],disabled:{type:Boolean,default:void 0},indeterminate:Boolean,label:String,focusable:{type:Boolean,default:!0},checkedValue:{type:[Boolean,String,Number],default:!0},uncheckedValue:{type:[Boolean,String,Number],default:!1},"onUpdate:checked":[Function,Array],onUpdateChecked:[Function,Array],privateInsideTable:Boolean,onChange:[Function,Array]}),oo=te({name:"Checkbox",props:pt,setup(e){const t=Te(Ne,null),n=V(null),{mergedClsPrefixRef:o,inlineThemeDisabled:s,mergedRtlRef:i}=xe(e),m=V(e.defaultChecked),v=de(e,"checked"),g=Ce(v,m),d=le(()=>{if(t){const u=t.valueSetRef.value;return u&&e.value!==void 0?u.has(e.value):!1}else return g.value===e.checkedValue}),k=Se(e,{mergedSize(u){const{size:D}=e;if(D!==void 0)return D;if(t){const{value:T}=t.mergedSizeRef;if(T!==void 0)return T}if(u){const{mergedSize:T}=u;if(T!==void 0)return T.value}return"medium"},mergedDisabled(u){const{disabled:D}=e;if(D!==void 0)return D;if(t){if(t.disabledRef.value)return!0;const{maxRef:{value:T},checkedCountRef:P}=t;if(T!==void 0&&P.value>=T&&!d.value)return!0;const{minRef:{value:A}}=t;if(A!==void 0&&P.value<=A&&d.value)return!0}return u?u.disabled.value:!1}}),{mergedDisabledRef:p,mergedSizeRef:l}=k,y=Me("Checkbox","-checkbox",bt,Qe,e,o);function C(u){if(t&&e.value!==void 0)t.toggleCheckbox(!d.value,e.value);else{const{onChange:D,"onUpdate:checked":T,onUpdateChecked:P}=e,{nTriggerFormInput:A,nTriggerFormChange:oe}=k,U=d.value?e.uncheckedValue:e.checkedValue;T&&G(T,U,u),P&&G(P,U,u),D&&G(D,U,u),A(),oe(),m.value=U}}function x(u){p.value||C(u)}function $(u){if(!p.value)switch(u.key){case" ":case"Enter":C(u)}}function h(u){switch(u.key){case" ":u.preventDefault()}}const a={focus:()=>{var u;(u=n.value)===null||u===void 0||u.focus()},blur:()=>{var u;(u=n.value)===null||u===void 0||u.blur()}},E=Xe("Checkbox",i,o),z=b(()=>{const{value:u}=l,{common:{cubicBezierEaseInOut:D},self:{borderRadius:T,color:P,colorChecked:A,colorDisabled:oe,colorTableHeader:U,colorTableHeaderModal:ue,colorTableHeaderPopover:fe,checkMarkColor:c,checkMarkColorDisabled:f,border:r,borderFocus:L,borderDisabled:W,borderChecked:K,boxShadowFocus:ne,textColor:N,textColorDisabled:ae,checkMarkColorDisabledChecked:re,colorDisabledChecked:ve,borderDisabledChecked:he,labelPadding:j,labelLineHeight:Ie,labelFontWeight:Ee,[ke("fontSize",u)]:Pe,[ke("size",u)]:Le}}=y.value;return{"--n-label-line-height":Ie,"--n-label-font-weight":Ee,"--n-size":Le,"--n-bezier":D,"--n-border-radius":T,"--n-border":r,"--n-border-checked":K,"--n-border-focus":L,"--n-border-disabled":W,"--n-border-disabled-checked":he,"--n-box-shadow-focus":ne,"--n-color":P,"--n-color-checked":A,"--n-color-table":U,"--n-color-table-modal":ue,"--n-color-table-popover":fe,"--n-color-disabled":oe,"--n-color-disabled-checked":ve,"--n-text-color":N,"--n-text-color-disabled":ae,"--n-check-mark-color":c,"--n-check-mark-color-disabled":f,"--n-check-mark-color-disabled-checked":re,"--n-font-size":Pe,"--n-label-padding":j}}),R=s?Ye("checkbox",b(()=>l.value[0]),z,e):void 0;return Object.assign(k,a,{rtlEnabled:E,selfRef:n,mergedClsPrefix:o,mergedDisabled:p,renderedChecked:d,mergedTheme:y,labelId:qe(),handleClick:x,handleKeyUp:$,handleKeyDown:h,cssVars:s?void 0:z,themeClass:R==null?void 0:R.themeClass,onRender:R==null?void 0:R.onRender})},render(){var e;const{$slots:t,renderedChecked:n,mergedDisabled:o,indeterminate:s,privateInsideTable:i,cssVars:m,labelId:v,label:g,mergedClsPrefix:d,focusable:k,handleKeyUp:p,handleKeyDown:l,handleClick:y}=this;(e=this.onRender)===null||e===void 0||e.call(this);const C=Ue(t.default,x=>g||x?B("span",{class:`${d}-checkbox__label`,id:v},g||x):null);return B("div",{ref:"selfRef",class:[`${d}-checkbox`,this.themeClass,this.rtlEnabled&&`${d}-checkbox--rtl`,n&&`${d}-checkbox--checked`,o&&`${d}-checkbox--disabled`,s&&`${d}-checkbox--indeterminate`,i&&`${d}-checkbox--inside-table`,C&&`${d}-checkbox--show-label`],tabindex:o||!k?void 0:0,role:"checkbox","aria-checked":s?"mixed":n,"aria-labelledby":v,style:m,onKeyup:p,onKeydown:l,onClick:y,onMousedown:()=>{We("selectstart",window,x=>{x.preventDefault()},{once:!0})}},B("div",{class:`${d}-checkbox-box-wrapper`}," ",B("div",{class:`${d}-checkbox-box`},B(Ke,null,{default:()=>this.indeterminate?B("div",{key:"indeterminate",class:`${d}-checkbox-icon`},ht()):B("div",{key:"check",class:`${d}-checkbox-icon`},vt())}),B("div",{class:`${d}-checkbox-box__border`}))),C)}}),_e=1,De=$e("n-grid"),Ae=1,mt={span:{type:[Number,String],default:Ae},offset:{type:[Number,String],default:0},suffix:Boolean,privateOffset:Number,privateSpan:Number,privateColStart:Number,privateShow:{type:Boolean,default:!0}},no=te({__GRID_ITEM__:!0,name:"GridItem",alias:["Gi"],props:mt,setup(){const{isSsrRef:e,xGapRef:t,itemStyleRef:n,overflowRef:o,layoutShiftDisabledRef:s}=Te(De),i=Je();return{overflow:o,itemStyle:n,layoutShiftDisabled:s,mergedXGap:b(()=>Q(t.value||0)),deriveStyle:()=>{e.value;const{privateSpan:m=Ae,privateShow:v=!0,privateColStart:g=void 0,privateOffset:d=0}=i.vnode.props,{value:k}=t,p=Q(k||0);return{display:v?"":"none",gridColumn:`${g??`span ${m}`} / span ${m}`,marginLeft:d?`calc((100% - (${m} - 1) * ${p}) / ${m} * ${d} + ${p} * ${d})`:""}}}},render(){var e,t;if(this.layoutShiftDisabled){const{span:n,offset:o,mergedXGap:s}=this;return B("div",{style:{gridColumn:`span ${n} / span ${n}`,marginLeft:o?`calc((100% - (${n} - 1) * ${s}) / ${n} * ${o} + ${s} * ${o})`:""}},this.$slots)}return B("div",{style:[this.itemStyle,this.deriveStyle()]},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e,{overflow:this.overflow}))}}),gt={xs:0,s:640,m:1024,l:1280,xl:1536,xxl:1920},Ge=24,be="__ssr__",xt={layoutShiftDisabled:Boolean,responsive:{type:[String,Boolean],default:"self"},cols:{type:[Number,String],default:Ge},itemResponsive:Boolean,collapsed:Boolean,collapsedRows:{type:Number,default:1},itemStyle:[Object,String],xGap:{type:[Number,String],default:0},yGap:{type:[Number,String],default:0}},ao=te({name:"Grid",inheritAttrs:!1,props:xt,setup(e){const{mergedClsPrefixRef:t,mergedBreakpointsRef:n}=xe(e),o=/^\d+$/,s=V(void 0),i=dt((n==null?void 0:n.value)||gt),m=le(()=>!!(e.itemResponsive||!o.test(e.cols.toString())||!o.test(e.xGap.toString())||!o.test(e.yGap.toString()))),v=b(()=>{if(m.value)return e.responsive==="self"?s.value:i.value}),g=le(()=>{var h;return(h=Number(Y(e.cols.toString(),v.value)))!==null&&h!==void 0?h:Ge}),d=le(()=>Y(e.xGap.toString(),v.value)),k=le(()=>Y(e.yGap.toString(),v.value)),p=h=>{s.value=h.contentRect.width},l=h=>{nt(p,h)},y=V(!1),C=b(()=>{if(e.responsive==="self")return l}),x=V(!1),$=V();return et(()=>{const{value:h}=$;h&&h.hasAttribute(be)&&(h.removeAttribute(be),x.value=!0)}),Re(De,{layoutShiftDisabledRef:de(e,"layoutShiftDisabled"),isSsrRef:x,itemStyleRef:de(e,"itemStyle"),xGapRef:d,overflowRef:y}),{isSsr:!tt,contentEl:$,mergedClsPrefix:t,style:b(()=>e.layoutShiftDisabled?{width:"100%",display:"grid",gridTemplateColumns:`repeat(${e.cols}, minmax(0, 1fr))`,columnGap:Q(e.xGap),rowGap:Q(e.yGap)}:{width:"100%",display:"grid",gridTemplateColumns:`repeat(${g.value}, minmax(0, 1fr))`,columnGap:Q(d.value),rowGap:Q(k.value)}),isResponsive:m,responsiveQuery:v,responsiveCols:g,handleResize:C,overflow:y}},render(){if(this.layoutShiftDisabled)return B("div",ye({ref:"contentEl",class:`${this.mergedClsPrefix}-grid`,style:this.style},this.$attrs),this.$slots);const e=()=>{var t,n,o,s,i,m,v;this.overflow=!1;const g=ot(st(this)),d=[],{collapsed:k,collapsedRows:p,responsiveCols:l,responsiveQuery:y}=this;g.forEach(a=>{var E,z,R,u,D;if(((E=a==null?void 0:a.type)===null||E===void 0?void 0:E.__GRID_ITEM__)!==!0)return;if(ut(a)){const A=we(a);A.props?A.props.privateShow=!1:A.props={privateShow:!1},d.push({child:A,rawChildSpan:0});return}a.dirs=((z=a.dirs)===null||z===void 0?void 0:z.filter(({dir:A})=>A!==ge))||null,((R=a.dirs)===null||R===void 0?void 0:R.length)===0&&(a.dirs=null);const T=we(a),P=Number((D=Y((u=T.props)===null||u===void 0?void 0:u.span,y))!==null&&D!==void 0?D:_e);P!==0&&d.push({child:T,rawChildSpan:P})});let C=0;const x=(t=d[d.length-1])===null||t===void 0?void 0:t.child;if(x!=null&&x.props){const a=(n=x.props)===null||n===void 0?void 0:n.suffix;a!==void 0&&a!==!1&&(C=Number((s=Y((o=x.props)===null||o===void 0?void 0:o.span,y))!==null&&s!==void 0?s:_e),x.props.privateSpan=C,x.props.privateColStart=l+1-C,x.props.privateShow=(i=x.props.privateShow)!==null&&i!==void 0?i:!0)}let $=0,h=!1;for(const{child:a,rawChildSpan:E}of d){if(h&&(this.overflow=!0),!h){const z=Number((v=Y((m=a.props)===null||m===void 0?void 0:m.offset,y))!==null&&v!==void 0?v:0),R=Math.min(E+z,l);if(a.props?(a.props.privateSpan=R,a.props.privateOffset=z):a.props={privateSpan:R,privateOffset:z},k){const u=$%l;R+u>l&&($+=l-u),R+$+C>p*l?h=!0:$+=R}}h&&(a.props?a.props.privateShow!==!0&&(a.props.privateShow=!1):a.props={privateShow:!1})}return B("div",ye({ref:"contentEl",class:`${this.mergedClsPrefix}-grid`,style:this.style,[be]:this.isSsr||void 0},this.$attrs),d.map(({child:a})=>a))};return this.isResponsive&&this.responsive==="self"?B(Ze,{onResize:this.handleResize},{default:e}):e()}}),kt={class:"allocation-wrap"},yt={key:0,class:"allocation-layout"},wt=["viewBox"],_t=["transform"],St=["stroke","stroke-dasharray","stroke-dashoffset","onMouseenter"],Ct={class:"donut-core"},$t={class:"core-label"},Rt={class:"core-value"},Mt={key:0,class:"core-share"},Tt={class:"side-panel"},Bt=["onMouseenter"],zt={class:"legend-name"},Nt={class:"legend-share"},Dt={key:1,class:"empty"},pe=220,me=30,At=te({__name:"AssetAllocationDonutChart",props:{rows:{}},setup(e){const t=e,n=V(null),o=pe/2,s=o-me/2-4,i=2*Math.PI*s,m=b(()=>t.rows.reduce((k,p)=>k+p.valueTwd,0)),v=b(()=>{let k=0;return t.rows.map(p=>{const l=Math.max(0,p.share)/100,y=i*l,C={...p,dasharray:`${y} ${Math.max(0,i-y)}`,dashoffset:-k};return k+=y,C})}),g=b(()=>n.value?t.rows.find(k=>k.key===n.value)??null:null);function d(k){return`${Math.round(k)}%`}return(k,p)=>(w(),_("div",kt,[e.rows.length>0?(w(),_("div",yt,[S("div",{class:"donut-shell",onMouseleave:p[0]||(p[0]=l=>n.value=null)},[(w(),_("svg",{viewBox:`0 0 ${pe} ${pe}`,class:"donut-svg",role:"img","aria-label":"資產佔比圖"},[S("circle",{cx:o,cy:o,r:s,"stroke-width":me,class:"donut-track"}),S("g",{transform:`rotate(-90 ${o} ${o})`},[(w(!0),_(J,null,Z(v.value,l=>(w(),_("circle",{key:l.key,cx:o,cy:o,r:s,class:ee(["donut-segment",{"is-active":n.value===l.key}]),stroke:l.color,"stroke-width":me,"stroke-dasharray":l.dasharray,"stroke-dashoffset":l.dashoffset,onMouseenter:y=>n.value=l.key},null,42,St))),128))],8,_t)],8,wt)),S("div",Ct,[S("div",$t,I(g.value?g.value.label:"資產佔比"),1),S("div",Rt,I(ie(ce)(g.value?g.value.valueTwd:m.value)),1),g.value?(w(),_("div",Mt,I(d(g.value.share)),1)):q("",!0)])],32),S("div",Tt,[S("div",{class:"legend",onMouseleave:p[1]||(p[1]=l=>n.value=null)},[(w(!0),_(J,null,Z(e.rows,l=>(w(),_("div",{key:l.key,class:ee(["legend-row",{"legend-active":n.value===l.key}]),onMouseenter:y=>n.value=l.key},[S("span",{class:"legend-dot",style:Be({background:l.color})},null,4),S("span",zt,I(l.label),1),S("span",Nt,I(Math.round(l.share))+"%",1)],42,Bt))),128))],32)])])):(w(),_("div",Dt,"本月沒有可用資產資料"))]))}}),ro=ze(At,[["__scopeId","data-v-23fdf019"]]),Gt={key:0,class:"empty"},It=["viewBox"],Et=["x1","y1","x2","y2"],Pt=["x1","y1","x2","y2"],Lt=["x1","y1","x2","y2"],Ft=["x","y"],Vt=["d"],jt=["points"],Ht=["cx","cy","r","onMouseenter"],Ot=["cx","cy","r"],Ut=["x","y","text-anchor"],Kt=["x","y"],Wt={class:"tip-head"},Xt={key:0,class:"tip-list"},Yt={class:"tip-name"},qt={key:0,class:"tip-more"},O=980,Qt=280,Jt=te({__name:"CombinedWaterLineChart",props:{points:{},details:{},showBreakdown:{type:Boolean},maxBreakdownRows:{},chartHeight:{},showPointValues:{type:Boolean},preset:{}},setup(e){const t=e,n=b(()=>t.preset==="dashboard"),o=b(()=>n.value?{top:28,right:168,bottom:78,left:84}:{top:20,right:92,bottom:52,left:28}),s=b(()=>Math.max(240,t.chartHeight??Qt)),i=b(()=>s.value-o.value.bottom),m=b(()=>n.value?13:9),v=b(()=>n.value?5.2:3.8),g=b(()=>n.value?16:11),d=b(()=>n.value?32:22),k=b(()=>t.points.map(c=>c.totalTwd)),p=V(null),l=b(()=>{if(k.value.length===0)return{min:0,max:100,step:20};const c=Math.min(...k.value),f=Math.max(...k.value);if(c===f){if(c===0)return{min:0,max:100,step:20};const j=Math.pow(10,Math.floor(Math.log10(Math.abs(c))))||10;return{min:Math.floor(c/j)*j-j,max:Math.ceil(f/j)*j+j,step:j}}const W=(f-c)*1.25/5,K=Math.pow(10,Math.floor(Math.log10(W))),ne=W/K;let N=K;ne<=1?N=1*K:ne<=2?N=2*K:ne<=5?N=5*K:N=10*K,N=Math.max(1,Math.round(N));const ae=Math.floor(c/N)*N,re=Math.ceil(f/N)*N,ve=c-ae<N*.1?ae-N:ae,he=re-f<N*.1?re+N:re;return{min:ve,max:he,step:N}});function y(c){const f=O-o.value.left-o.value.right;return t.points.length<=1?o.value.left+f/2:o.value.left+f*c/(t.points.length-1)}function C(c){const f=s.value-o.value.top-o.value.bottom,r=l.value,L=(c-r.min)/(r.max-r.min);return o.value.top+f-L*f}const x=b(()=>t.points.map((c,f)=>`${y(f)},${C(c.totalTwd)}`).join(" ")),$=b(()=>{if(h.value.length===0)return"";const f=`M ${h.value[0].x} ${i.value}`,r=h.value.map(W=>`L ${W.x} ${W.y}`).join(" "),L=`L ${h.value[h.value.length-1].x} ${i.value} Z`;return`${f} ${r} ${L}`}),h=b(()=>t.points.map((c,f)=>({...c,index:f,x:y(f),y:C(c.totalTwd)}))),a=b(()=>p.value===null?null:h.value[p.value]??null),E=b(()=>{const c=new Map;for(const f of t.details??[])c.set(f.key,f);return c}),z=b(()=>{const c=a.value;return c?E.value.get(c.key)??null:null}),R=b(()=>{if(!t.showBreakdown||!z.value)return[];const c=Math.max(1,t.maxBreakdownRows??6);return z.value.breakdown.slice(0,c)}),u=b(()=>{if(!t.showBreakdown||!z.value)return 0;const c=Math.max(1,t.maxBreakdownRows??6);return Math.max(0,z.value.breakdown.length-c)}),D=b(()=>{const c=l.value,f=[];for(let r=c.max;r>=c.min;r-=c.step)f.push({y:C(r),value:r});return f}),T=b(()=>t.points.length<=8?1:Math.ceil(t.points.length/8));function P(c){return rt(c)}function A(c){const[f,r]=c.split("-");return!f||!r?c:`${f}/${r}`}function oe(c,f,r){return r<=1?f:c===0?f+(n.value?8:6):c===r-1?f-(n.value?10:6):f}function U(c,f){return f<=1?"middle":c===0?"start":c===f-1?"end":"middle"}const ue=b(()=>a.value?{left:`${a.value.x/O*100}%`,top:`${a.value.y/s.value*100}%`}:{}),fe=b(()=>a.value?a.value.x>O*.62?"tip-left":"tip-right":"");return(c,f)=>(w(),_("div",{class:ee(["chart-shell",{"preset-dashboard":n.value}])},[e.points.length===0?(w(),_("div",Gt,"目前區間沒有資料")):(w(),_("svg",{key:1,viewBox:`0 0 ${O} ${s.value}`,class:"chart-svg",role:"img","aria-label":"選取帳戶加總水位折線圖",onMouseleave:f[0]||(f[0]=r=>p.value=null)},[S("line",{x1:o.value.left,y1:i.value,x2:O-o.value.right,y2:i.value,class:"axis"},null,8,Et),S("line",{x1:O-o.value.right,y1:o.value.top,x2:O-o.value.right,y2:i.value,class:"axis"},null,8,Pt),(w(!0),_(J,null,Z(D.value,r=>(w(),_("g",{key:r.y},[S("line",{x1:o.value.left,y1:r.y,x2:O-o.value.right,y2:r.y,class:"grid-line"},null,8,Lt),S("text",{x:O-o.value.right+16,y:r.y+6,class:"y-label"},I(P(r.value)),9,Ft)]))),128)),$.value?(w(),_("path",{key:0,d:$.value,class:"area-fill"},null,8,Vt)):q("",!0),S("polyline",{points:x.value,class:"trend-line"},null,8,jt),(w(!0),_(J,null,Z(h.value,r=>(w(),_("g",{key:r.key},[S("circle",{cx:r.x,cy:r.y,r:m.value,class:"dot-hit",onMouseenter:L=>p.value=r.index},null,40,Ht),S("circle",{cx:r.x,cy:r.y,r:v.value,class:ee(["dot",{"dot-active":p.value===r.index}])},[S("title",null,I(r.month)+" "+I(ie(ce)(r.totalTwd)),1)],10,Ot),p.value===r.index?(w(),_("text",{key:0,x:oe(r.index,r.x,h.value.length),y:r.y-g.value,"text-anchor":U(r.index,h.value.length),class:"edge-value"},I(ie(ce)(r.totalTwd)),9,Ut)):q("",!0)]))),128)),(w(!0),_(J,null,Z(e.points,(r,L)=>at((w(),_("text",{key:`label-${r.key}`,x:y(L),y:i.value+d.value,class:"x-label"},I(A(r.month)),9,Kt)),[[ge,L%T.value===0||L===e.points.length-1]])),128))],40,It)),a.value?(w(),_("div",{key:2,class:ee(["hover-tip",fe.value]),style:Be(ue.value)},[S("div",Wt,[S("span",null,I(a.value.month),1),S("strong",null,I(ie(ce)(a.value.totalTwd)),1)]),e.showBreakdown&&R.value.length>0?(w(),_("div",Xt,[(w(!0),_(J,null,Z(R.value,r=>(w(),_("div",{key:`${a.value.key}-${r.accountId}`,class:"tip-row"},[S("span",Yt,I(r.accountName),1),S("span",{class:ee(["tip-impact",r.type==="asset"?"is-up":"is-down"])},I(ie(ce)(r.signedTwd)),3)]))),128)),u.value>0?(w(),_("div",qt,"+"+I(u.value)+" 個帳戶",1)):q("",!0)])):q("",!0)],6)):q("",!0)],2))}}),so=ze(Jt,[["__scopeId","data-v-6c585a93"]]);export{ro as A,so as C,ao as N,no as a,oo as b,to as c};
